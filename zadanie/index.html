<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Memory</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <link rel="stylesheet" href="style.css">
        <script type="text/javascript">
var ostatniObrazek = "";
var current = "";
var ruch = 0;
var pkt = 0;
var zostalo = 16;
         // Funkcja losująca obrazki
    var obrazki = [
     'obrazek_1.png',
     'obrazek_2.png',
     'obrazek_3.png',
     'obrazek_4.png',
     'obrazek_5.png',
     'obrazek_6.png',
     'obrazek_7.png',
     'obrazek_8.png',
     'obrazek_1.png',
     'obrazek_2.png',
     'obrazek_3.png',
     'obrazek_4.png',
     'obrazek_5.png',
     'obrazek_6.png',
     'obrazek_7.png',
     'obrazek_8.png'];
    $(document).ready(function(){

          $('.obrazek').each(function() {


       var los = obrazki[Math.floor(Math.random()* obrazki.length)];
       var id = Math.floor(Math.random()* 100+1);
      img = $(this);
      img.attr("data-obrazek", los);
      img.attr("data-id", id);

      var itemtoRemove = los;
       obrazki.splice($.inArray(itemtoRemove, obrazki),1);


    });

        $('.obrazek').click(function(){
        img = $(this);
        obrazek = img.attr('data-obrazek');
        console.log("obecny: "+obrazek+" ostatni:"+ostatniObrazek);
        dodajRuch();
        img.attr('src', obrazek);

        var id = img.attr('data-id');
        if(ostatniObrazek == ""){

          ostatniObrazek = obrazek;
          current = id;
      }else if(ostatniObrazek == obrazek && current != id)
      {
                dodajPunkty();
                zostalo = zostalo -2;
                console.log("Do odgadniecia zostalo: " + zostalo);
                if(zostalo == 0){koniec();}
              $(this).removeClass( "obrazek" ).addClass( "wygrana" );
                $(".obrazek").each(function(){
                  test = $(this);
                  if(test.attr('src') == ostatniObrazek){
                    $(this).removeClass( "obrazek" ).addClass( "wygrana" );
                  }
              });

              ostatniObrazek = "";
              current = "";


        } else {
          ostatniObrazek = "";
          current = "";
          setTimeout(function(){

         $('.obrazek').attr('src', "back.png");
       }, 450);
        }












      });


          function dodajPunkty(){
              pkt = pkt + 100/ruch;
              var p = pkt.toFixed(2);
                $('#pkt').text(p);

          }

          function koniec(){
            setTimeout(function(){
              $('.plansza').hide();
             $('.test').removeClass('ukryj');

         }, 200);
         var iloscPkt = pkt.toFixed(2);
         var iloscProb = ruch;
          $('#iloscPkt').text(iloscPkt);
          $('#iloscProb').text(iloscProb);
          }
          function dodajRuch(){
            ruch = ruch+1;
          $('#ruchy').text(ruch);

          }




        // document ready \/
      });










        </script>
  </head>
  <body>



      <div class="plansza">
        <!-- /1-->
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"/></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id=""  class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <!-- /1-->
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <!-- /1-->
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>

          <!-- /1-->
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>
          <div class="kafelek"><img src="back.png" alt="test" data-obrazek="1" data-id="" class="obrazek"></div>

          <div class="pkt">
            <span>Punktów:</span>
            <span id="pkt">0</span>
          </div>
          <div class="ruchy">
              <span>Ilość ruchów:</span>
              <span id="ruchy">0</span>
          </div>

      </div>
      <div class="test ukryj" style="width:500px;height:250px;margin:0 auto;color:#fff;margin-top:20px;">
          <h2 style="text-align:center;font-family:'Arial';">Koniec gry!</h4>
          <div class="podsumowanie">
              <div class="punkty">
                Zdobyta ilość punktów w grze: <br/>
                <span id="iloscPkt">0</span>
              </div>
              <div class="iloscRuchow">
                  Wykonana ilość ruchów w grze: <br />
                <span id="iloscProb">0</span>
              </div>
          </div>
        <button type="button" onclick="location.reload()" style="margin-left:150px;">Zagraj Ponownie</button>
      </div>



  </body>
</html>
